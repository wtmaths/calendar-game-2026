<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>2026 å¹´é¦™æ¸¯æœˆæ›†å°éŠæˆ²ï¼ˆå®˜æ–¹å…¬çœ¾å‡æœŸï¼‰</title>
  <style>
    body {
      font-family: "Microsoft JhengHei", sans-serif;
      background: #f2f7ff;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    h1 {
      color: #2b4c7e;
    }
    #game-container {
      max-width: 720px;
      margin: 0 auto;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 20px;
    }
    #controls {
      margin-bottom: 10px;
    }
    select, button, input {
      font-size: 16px;
      padding: 5px 10px;
      margin: 5px;
    }
    #question {
      font-size: 18px;
      margin: 10px 0 15px 0;
      color: #333;
    }
    table.calendar {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }
    table.calendar th, table.calendar td {
      border: 1px solid #ddd;
      width: 14.28%;
      height: 50px;
      text-align: center;
      vertical-align: middle;
      user-select: none;
    }
    table.calendar th {
      background: #e3ecff;
      color: #2b4c7e;
      font-weight: bold;
    }
    /* æ˜ŸæœŸæ—¥ç´…è‰²å­—é«” */
    table.calendar td.sunday {
      color: red;
    }
    /* å…¬çœ¾å‡æœŸç´…è‰²èƒŒæ™¯+ç™½è‰²å­—é«” */
    table.calendar td.holiday {
      background: #ff4444 !important;
      color: white;
      font-weight: bold;
    }
    table.calendar td {
      background: #fafafa;
      cursor: pointer;
      position: relative;
    }
    table.calendar td.empty {
      background: #f5f5f5;
      cursor: default;
      color: initial;
    }
    table.calendar td:hover:not(.empty):not(.holiday) {
      background: #ffe9b3;
    }
    table.calendar td.correct {
      background: #c6f6c6 !important;
      color: #333;
    }
    table.calendar td.wrong {
      background: #ffc9c9;
      animation: shake 0.2s;
    }
    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-3px); }
      50% { transform: translateX(3px); }
      75% { transform: translateX(-3px); }
      100% { transform: translateX(0); }
    }
    #message {
      margin-top: 10px;
      font-size: 16px;
      font-weight: bold;
    }
    #hint {
      margin-top: 5px;
      font-size: 14px;
      color: #666;
    }
    .legend {
      margin-top: 15px;
      font-size: 14px;
      text-align: left;
      background: #f8f9ff;
      padding: 15px;
      border-radius: 5px;
    }
    #weekdayGuessInput {
      width: 150px;
      font-size: 16px;
    }
    .holiday-info {
      position: absolute;
      bottom: -25px;
      left: 50%;
      transform: translateX(-50%);
      background: #cc0000;
      color: white;
      font-size: 11px;
      padding: 2px 4px;
      border-radius: 3px;
      white-space: nowrap;
      display: none;
      z-index: 10;
    }
  </style>
</head>
<body>
  <div id="game-container">
    <h1>2026 å¹´é¦™æ¸¯æœˆæ›†å°éŠæˆ²ï¼ˆå®˜æ–¹å…¬çœ¾å‡æœŸï¼‰</h1>
    <div id="controls">
      <label for="monthSelect">é¸æ“‡æœˆä»½ï¼š</label>
      <select id="monthSelect">
        <option value="0">1 æœˆ</option>
        <option value="1">2 æœˆ</option>
        <option value="2">3 æœˆ</option>
        <option value="3">4 æœˆ</option>
        <option value="4">5 æœˆ</option>
        <option value="5">6 æœˆ</option>
        <option value="6">7 æœˆ</option>
        <option value="7">8 æœˆ</option>
        <option value="8">9 æœˆ</option>
        <option value="9">10 æœˆ</option>
        <option value="10">11 æœˆ</option>
        <option value="11">12 æœˆ</option>
      </select>

      <label for="questionType">é¡Œå‹ï¼š</label>
      <select id="questionType">
        <option value="nthWeekday">æ‰¾ç¬¬ N å€‹æ˜ŸæœŸå¹¾æ˜¯å¹¾è™Ÿï¼Ÿ</option>
        <option value="weekdayOfDate">å•æŸä¸€å¤©æ˜¯æ˜ŸæœŸå¹¾ï¼Ÿ</option>
        <option value="countSundays">æ‰¾è©²æœˆæœ‰å¹¾å€‹æ˜ŸæœŸæ—¥ï¼Ÿ</option>
        <option value="findHoliday">æ‰¾å‡ºå…¬çœ¾å‡æœŸæ—¥æœŸ</option>
        <option value="holidayCount">è©²æœˆæœ‰å¹¾å€‹å…¬çœ¾å‡æœŸï¼Ÿ</option>
      </select>

      <button id="newQuestionBtn">å‡ºæ–°é¡Œç›®</button>
    </div>

    <div id="question">è«‹æŒ‰ã€Œå‡ºæ–°é¡Œç›®ã€é–‹å§‹ã€‚</div>

    <table class="calendar" id="calendarTable">
      <thead>
        <tr>
          <th>æ—¥</th>
          <th>ä¸€</th>
          <th>äºŒ</th>
          <th>ä¸‰</th>
          <th>å››</th>
          <th>äº”</th>
          <th>å…­</th>
        </tr>
      </thead>
      <tbody id="calendarBody"></tbody>
    </table>

    <div id="interactionArea"></div>

    <div id="message"></div>
    <div id="hint"></div>

    <div class="legend">
      <strong>åœ–ä¾‹èªªæ˜ï¼š</strong><br />
      <span style="color:red;">ğŸ”´ ç´…å­— = æ˜ŸæœŸæ—¥</span><br />
      <span style="background:#ff4444;color:white;padding:2px 5px;border-radius:3px;">ğŸ›‘ ç´…åº•ç™½å­— = å…¬çœ¾å‡æœŸ</span><br />
      <strong>è³‡æ–™ä¾†æºï¼š</strong>é¦™æ¸¯æ”¿åºœä¸€ç«™é€šï¼ˆ2026å¹´å…¬çœ¾å‡æœŸï¼‰[attached_file:1]<br />
      <strong>æ•™å­¸é‡é»ï¼š</strong><br />
      - å­¸ç”Ÿå¯å­¸ç¿’è¾¨èªå…¬çœ¾å‡æœŸä½ç½®åŠè¨ˆç®—å‡æœŸæ•¸é‡<br />
      - ã€Œæ‰¾å‡ºå…¬çœ¾å‡æœŸæ—¥æœŸã€ï¼šé»é¸ç´…åº•æ—¥æœŸç­”é¡Œ<br />
      - ã€Œè©²æœˆæœ‰å¹¾å€‹å…¬çœ¾å‡æœŸï¼Ÿã€ï¼šæ•¸ç´…åº•æ ¼å­æ•¸é‡
    </div>
  </div>

  <script>
    const year = 2026;
    
    // é¦™æ¸¯2026å¹´å®˜æ–¹å…¬çœ¾å‡æœŸï¼ˆè³‡æ–™ä¾†æºï¼šhttps://www.gov.hk/tc/about/abouthk/holiday/2026.htmï¼‰
    const HKPublicHolidays2026 = {
      0: [{date: 1, name: 'å…ƒæ—¦'}],                    // 1æœˆ1æ—¥
      1: [                                              // 2æœˆ
        {date: 17, name: 'è¾²æ›†å¹´åˆä¸€'},
        {date: 18, name: 'è¾²æ›†å¹´åˆäºŒ'},
        {date: 19, name: 'è¾²æ›†å¹´åˆä¸‰'}
      ],
      3: [                                              // 4æœˆ
        {date: 3, name: 'è€¶ç©Œå—é›£ç¯€'},
        {date: 4, name: 'è€¶ç©Œå—é›£ç¯€ç¿Œæ—¥'},
        {date: 6, name: 'æ¸…æ˜ç¯€ç¿Œæ—¥'},
        {date: 7, name: 'å¾©æ´»ç¯€æ˜ŸæœŸä¸€ç¿Œæ—¥'}
      ],
      4: [{date: 1, name: 'å‹å‹•ç¯€'}],                  // 5æœˆ1æ—¥
      5: [{date: 25, name: 'ä½›èª•ç¿Œæ—¥'}],               // 5æœˆ25æ—¥
      6: [{date: 19, name: 'ç«¯åˆç¯€'}, {date: 1, name: 'é¦™æ¸¯ç‰¹åˆ¥è¡Œæ”¿å€æˆç«‹ç´€å¿µæ—¥'}], // 6æœˆ19æ—¥, 7æœˆ1æ—¥
      8: [{date: 26, name: 'ä¸­ç§‹ç¯€ç¿Œæ—¥'}],             // 9æœˆ26æ—¥
      9: [{date: 1, name: 'åœ‹æ…¶æ—¥'}],                  // 10æœˆ1æ—¥
      10: [{date: 19, name: 'é‡é™½ç¯€ç¿Œæ—¥'}],            // 10æœˆ19æ—¥
      11: [                                             // 12æœˆ
        {date: 25, name: 'è–èª•ç¯€'},
        {date: 26, name: 'è–èª•ç¯€å¾Œç¬¬ä¸€å€‹å‘¨æ—¥'}
      ]
    };

    const monthSelect = document.getElementById('monthSelect');
    const questionTypeSelect = document.getElementById('questionType');
    const calendarBody = document.getElementById('calendarBody');
    const questionDiv = document.getElementById('question');
    const messageDiv = document.getElementById('message');
    const hintDiv = document.getElementById('hint');
    const newQuestionBtn = document.getElementById('newQuestionBtn');
    const interactionArea = document.getElementById('interactionArea');

    let currentMonth = 0;
    let currentQuestionType = 'nthWeekday';

    // é¡Œç›®è®Šæ•¸
    let targetWeekIndex = 1;
    let targetWeekday = 0;
    let answerDate = null;
    let targetDate = null;
    let countAnswer = null;
    let targetHoliday = null;

    const weekdaysNames = ['æ˜ŸæœŸæ—¥', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­'];
    const orderNames = ['ç¬¬ 1 å€‹', 'ç¬¬ 2 å€‹', 'ç¬¬ 3 å€‹', 'ç¬¬ 4 å€‹', 'ç¬¬ 5 å€‹'];

    // ç”¢ç”Ÿæœˆæ›†ï¼ˆå«å®˜æ–¹å…¬çœ¾å‡æœŸæ¨™ç¤ºï¼‰
    function generateCalendar(month) {
      calendarBody.innerHTML = '';
      currentMonth = month;

      const firstDay = new Date(year, month, 1);
      const lastDay = new Date(year, month + 1, 0);
      const firstWeekday = firstDay.getDay();
      const daysInMonth = lastDay.getDate();
      const holidays = HKPublicHolidays2026[month] || [];

      let row = document.createElement('tr');
      for (let i = 0; i < firstWeekday; i++) {
        const cell = document.createElement('td');
        cell.classList.add('empty');
        row.appendChild(cell);
      }

      for (let date = 1; date <= daysInMonth; date++) {
        const cell = document.createElement('td');
        cell.textContent = date;
        cell.dataset.date = date;
        cell.title = `${year}å¹´${month+1}æœˆ${date}æ—¥`;

        // åˆ¤æ–·æ˜ŸæœŸå¹¾
        const weekday = (firstWeekday + date - 1) % 7;
        if (weekday === 0) {
          cell.classList.add('sunday');
        }

        // åˆ¤æ–·æ˜¯å¦å…¬çœ¾å‡æœŸ
        const isHoliday = holidays.find(h => h.date === date);
        if (isHoliday) {
          cell.classList.add('holiday');
          const info = document.createElement('div');
          info.className = 'holiday-info';
          info.textContent = isHoliday.name;
          cell.appendChild(info);
        }

        // æ ¹æ“šé¡Œå‹è¨­å®šäº’å‹•
        setupCellInteraction(cell, date);

        row.appendChild(cell);

        if (weekday === 6 && date !== daysInMonth) {
          calendarBody.appendChild(row);
          row = document.createElement('tr');
        }
      }

      if (row.children.length > 0) {
        const remaining = 7 - row.children.length;
        for (let i = 0; i < remaining; i++) {
          const cell = document.createElement('td');
          cell.classList.add('empty');
          row.appendChild(cell);
        }
        calendarBody.appendChild(row);
      }
    }

    // æ ¹æ“šé¡Œå‹è¨­å®šå–®å…ƒæ ¼äº’å‹•
    function setupCellInteraction(cell, date) {
      cell.style.cursor = 'pointer';
      
      if (currentQuestionType === 'nthWeekday') {
        cell.addEventListener('click', () => handleDateClickNthWeekday(date, cell));
      } else if (currentQuestionType === 'weekdayOfDate') {
        cell.addEventListener('click', () => handleClickDateForWeekday(date));
      } else if (currentQuestionType === 'findHoliday') {
        cell.addEventListener('click', () => handleHolidayClick(date, cell));
      } else if (currentQuestionType === 'countSundays' || currentQuestionType === 'holidayCount') {
        cell.style.cursor = 'default';
      } else {
        cell.style.cursor = 'default';
      }

      // å…¬çœ¾å‡æœŸhoveré¡¯ç¤ºåç¨±
      cell.addEventListener('mouseenter', () => {
        if (cell.classList.contains('holiday')) {
          const info = cell.querySelector('.holiday-info');
          if (info) info.style.display = 'block';
        }
      });
      cell.addEventListener('mouseleave', () => {
        const info = cell.querySelector('.holiday-info');
        if (info) info.style.display = 'none';
      });
    }

    function findNthWeekdayDate(year, month, weekday, n) {
      const firstDay = new Date(year, month, 1);
      const firstWeekday = firstDay.getDay();
      let offset = weekday - firstWeekday;
      if (offset < 0) offset += 7;
      const firstTargetDate = 1 + offset;
      const targetDate = firstTargetDate + (n - 1) * 7;
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      return targetDate <= daysInMonth ? targetDate : null;
    }

    function countSundays(year, month) {
      let count = 0;
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      for (let d = 1; d <= daysInMonth; d++) {
        if (new Date(year, month, d).getDay() === 0) count++;
      }
      return count;
    }

    function getHolidaysInMonth(month) {
      return HKPublicHolidays2026[month] || [];
    }

    // é¡Œå‹1ï¼šç¬¬Nå€‹æ˜ŸæœŸXæ˜¯å¹¾è™Ÿ
    function handleDateClickNthWeekday(date, cell) {
      if (!answerDate) return;
      clearHighlight();
      if (date === answerDate) {
        cell.classList.add('correct');
        messageDiv.textContent = `ç­”å°äº†ï¼æ­£ç¢ºæ—¥æœŸæ˜¯ ${date} è™Ÿã€‚`;
        messageDiv.style.color = 'green';
      } else {
        cell.classList.add('wrong');
        messageDiv.textContent = `å†æƒ³ä¸€æƒ³ï½ ${date} è™Ÿä¸æ˜¯ç­”æ¡ˆã€‚`;
        messageDiv.style.color = 'red';
      }
    }

    // é¡Œå‹2ï¼šå•æŸå¤©æ˜¯æ˜ŸæœŸå¹¾
    function handleClickDateForWeekday(date) {
      clearHighlight();
      const weekday = new Date(year, currentMonth, date).getDay();
      messageDiv.style.color = '#2b4c7e';
      messageDiv.textContent = `2026 å¹´ ${currentMonth + 1} æœˆ ${date} è™Ÿæ˜¯${weekdaysNames[weekday]}`;
      highlightDateCell(date);
    }

    // é¡Œå‹4ï¼šæ‰¾å‡ºå…¬çœ¾å‡æœŸæ—¥æœŸ
    function handleHolidayClick(date, cell) {
      if (!targetHoliday) return;
      clearHighlight();
      if (date === targetHoliday.date) {
        cell.classList.add('correct');
        messageDiv.textContent = `ç­”å°äº†ï¼${targetHoliday.name} æ˜¯ ${date} è™Ÿã€‚`;
        messageDiv.style.color = 'green';
      } else {
        cell.classList.add('wrong');
        messageDiv.textContent = `${date} è™Ÿä¸æ˜¯å…¬çœ¾å‡æœŸï¼Œå†æ‰¾æ‰¾ç´…åº•æ—¥æœŸã€‚`;
        messageDiv.style.color = 'red';
      }
    }

    // é¡Œå‹3&5ï¼šè¨ˆæ•¸é¡Œå‹è¼¸å…¥æ¡†
    function setupCountInteraction(expectedAnswer, questionText) {
      interactionArea.innerHTML = '';
      const label = document.createElement('label');
      label.textContent = questionText;
      label.setAttribute('for', 'countInput');
      
      const input = document.createElement('input');
      input.type = 'number';
      input.id = 'countInput';
      input.min = 0;
      input.style.marginLeft = '10px';
      
      const btn = document.createElement('button');
      btn.textContent = 'æäº¤ç­”æ¡ˆ';
      
      btn.addEventListener('click', () => {
        const val = parseInt(input.value, 10);
        if (isNaN(val)) {
          messageDiv.textContent = 'è«‹è¼¸å…¥ä¸€å€‹æ•¸å­—ã€‚';
          messageDiv.style.color = 'red';
          return;
        }
        if (val === expectedAnswer) {
          messageDiv.textContent = `ç­”å°äº†ï¼${expectedAnswer} æ˜¯æ­£ç¢ºæ•¸ç›®ã€‚`;
          messageDiv.style.color = 'green';
        } else {
          messageDiv.textContent = `å†æ•¸ä¸€æ•¸ï½`;
          messageDiv.style.color = 'red';
        }
      });
      
      interactionArea.appendChild(label);
      interactionArea.appendChild(input);
      interactionArea.appendChild(btn);
    }

    function clearHighlight() {
      messageDiv.textContent = '';
      hintDiv.textContent = '';
      interactionArea.innerHTML = '';
      const cells = calendarBody.querySelectorAll('td');
      cells.forEach(c => {
        c.classList.remove('correct', 'wrong', 'selected');
      });
    }

    function highlightDateCell(date) {
      const cells = calendarBody.querySelectorAll('td');
      cells.forEach(c => {
        if (parseInt(c.dataset.date) === date) {
          c.classList.add('correct');
        }
      });
    }

    // å‡ºæ–°é¡Œç›®
    function generateQuestion() {
      clearHighlight();
      currentMonth = parseInt(monthSelect.value, 10);
      currentQuestionType = questionTypeSelect.value;
      generateCalendar(currentMonth);

      const holidays = getHolidaysInMonth(currentMonth);
      const monthName = currentMonth + 1;

      if (currentQuestionType === 'nthWeekday') {
        targetWeekday = Math.floor(Math.random() * 7);
        targetWeekIndex = Math.floor(Math.random() * 4) + 1;
        answerDate = findNthWeekdayDate(year, currentMonth, targetWeekday, targetWeekIndex);
        if (!answerDate) { generateQuestion(); return; }
        questionDiv.textContent = `é¡Œç›®ï¼šè«‹æ‰¾å‡º 2026 å¹´ ${monthName} æœˆçš„ ${orderNames[targetWeekIndex-1]} ${weekdaysNames[targetWeekday]} æ˜¯å¹¾è™Ÿï¼Ÿ`;
        hintDiv.textContent = 'æç¤ºï¼šè«‹åœ¨æœˆæ›†ä¸­é»é¸æ­£ç¢ºæ—¥æœŸã€‚';

      } else if (currentQuestionType === 'weekdayOfDate') {
        const daysInMonth = new Date(year, currentMonth + 1, 0).getDate();
        targetDate = Math.floor(Math.random() * daysInMonth) + 1;
        questionDiv.textContent = `é¡Œç›®ï¼š2026 å¹´ ${monthName} æœˆ ${targetDate} è™Ÿæ˜¯æ˜ŸæœŸå¹¾ï¼Ÿ`;
        hintDiv.textContent = 'æç¤ºï¼šé»é¸è©²æ—¥æœŸæŸ¥çœ‹ç­”æ¡ˆã€‚';

      } else if (currentQuestionType === 'countSundays') {
        countAnswer = countSundays(year, currentMonth);
        questionDiv.textContent = `é¡Œç›®ï¼š2026 å¹´ ${monthName} æœˆæœ‰å¹¾å€‹æ˜ŸæœŸæ—¥ï¼Ÿ`;
        hintDiv.textContent = 'æç¤ºï¼šæ•¸ç´…å­—æ—¥æœŸã€‚';
        setupCountInteraction(countAnswer, 'è«‹è¼¸å…¥æ˜ŸæœŸæ—¥æ•¸é‡ï¼š');

      } else if (currentQuestionType === 'findHoliday') {
        if (holidays.length === 0) {
          questionDiv.textContent = `2026 å¹´ ${monthName} æœˆæ²’æœ‰å…¬çœ¾å‡æœŸï¼`;
          hintDiv.textContent = 'è«‹é¸æ“‡æœ‰å‡æœŸçš„æœˆä»½ç·´ç¿’ï¼ˆå¦‚2æœˆã€4æœˆï¼‰ã€‚';
          return;
        }
        targetHoliday = holidays[Math.floor(Math.random() * holidays.length)];
        questionDiv.textContent = `é¡Œç›®ï¼š2026 å¹´ ${monthName} æœˆçš„ã€Œ${targetHoliday.name}ã€æ˜¯å¹¾è™Ÿï¼Ÿ`;
        hintDiv.textContent = 'æç¤ºï¼šæ‰¾ç´…åº•ç™½å­—çš„å…¬çœ¾å‡æœŸæ—¥æœŸé»é¸ã€‚';

      } else if (currentQuestionType === 'holidayCount') {
        countAnswer = holidays.length;
        questionDiv.textContent = `é¡Œç›®ï¼š2026 å¹´ ${monthName} æœˆæœ‰å¹¾å€‹å…¬çœ¾å‡æœŸï¼Ÿ`;
        hintDiv.textContent = 'æç¤ºï¼šæ•¸ç´…åº•æ ¼å­æ•¸é‡ã€‚';
        setupCountInteraction(countAnswer, 'è«‹è¼¸å…¥å…¬çœ¾å‡æœŸæ•¸é‡ï¼š');
      }
    }

    monthSelect.addEventListener('change', () => {
      generateCalendar(parseInt(monthSelect.value, 10));
      questionDiv.textContent = 'è«‹é¸æ“‡é¡Œå‹ä¸¦æŒ‰ã€Œå‡ºæ–°é¡Œç›®ã€ã€‚';
    });

    questionTypeSelect.addEventListener('change', generateQuestion);
    newQuestionBtn.addEventListener('click', generateQuestion);

    generateCalendar(0);
  </script>
</body>
</html>
